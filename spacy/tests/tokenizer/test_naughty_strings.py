# coding: utf-8
from __future__ import unicode_literals

import pytest

# Examples taken from the "Big List of Naughty Strings"
# https://github.com/minimaxir/big-list-of-naughty-strings


NAUGHTY_STRINGS = [
    # ASCII punctuation
    r",./;'[]\-=",
    r'<>?:"{}|_+',
    r'!@#$%^&*()`~"',
    # Unicode additional control characters, byte order marks
    r"ยญุุุุุุุแโโโโโโช",
    r"๏ฟพ",
    # Unicode Symbols
    r"ฮฉโรงโโซหยตโคโฅรท",
    r"รฅรโฦยฉหโหยฌโฆรฆ",
    "ลโยดยฎโยฅยจหรธฯโโ",
    r"ยกโขยฃยขโยงยถโขยชยบโโ",
    r"ยธหรโฤฑหรยฏหยฟ",
    r"รรรรหรร๏ฃฟรรรโ",
    r"ลโยดโฐหรยจหรโโโ",
    r"`โโฌโนโบ๏ฌ๏ฌโกยฐยทโโยฑ",
    r"โโโโ",
    r"ะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะกะขะฃะคะฅะฆะงะจะฉะชะซะฌะญะฎะฏะฐะฑะฒะณะดะตะถะทะธะนะบะปะผะฝะพะฟัััััััััััััััั",
    r"ููกูขูฃูคูฅูฆูงูจูฉ",
    # Unicode Subscript/Superscript/Accents
    r"โฐโดโต",
    r"โโโ",
    r"โฐโดโตโโโ",
    r"เธเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเน เธเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเน เธเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเน",
    # Two-Byte Characters
    r"็ฐไธญใใใซใใใฆไธใใ",
    r"ใใผใใฃใผใธ่กใใชใใ",
    r"ๅ่ฃฝๆผข่ช",
    r"้จ่ฝๆผ",
    r"์ฌํ๊ณผํ์ ์ดํ์ฐ๊ตฌ์",
    r"์ฐฆ์ฐจ๋ฅผ ํ๊ณ ์จ ํฒ์๋งจ๊ณผ ์๋ค๋ฆฌ ๋๋ฐฉ๊ฐํ",
    r"็คพๆ็งๅญธ้ข่ชๅญธ็็ฉถๆ",
    r"์ธ๋๋ฐํ๋ฅด",
    r"๐๐ฑ๐น๐ฑ๐ฑธ๐ฒ๐ณ",
    # Japanese Emoticons
    r"ใฝเผผเบูอเบเผฝ๏พ ใฝเผผเบูอเบเผฝ๏พ",
    r"(๏ฝกโ โ โ๏ฝก)",
    r"๏ฝ๏ฝจ(ยดโ๏ฝโฉ",
    r"__๏พ(,_,*)",
    r"ใป(๏ฟฃโ๏ฟฃ)ใป:*:",
    r"๏พ๏ฝฅโฟใพโฒ(๏ฝกโโฟโ๏ฝก)โฑโฟ๏ฝฅ๏พ",
    r",ใใป:*:ใปใโ( โป ฯ โป )ใใป:*:ใปใโ",
    r"(โฏยฐโกยฐ๏ผโฏ๏ธต โปโโป)" "(๏พเฒฅ็เฒฅ๏ผ๏พ๏ปฟ โปโโป",
    r"โฌโโฌใ( ยบ _ ยบใ)",
    r"( อกยฐ อส อกยฐ)",
    # Emoji
    r"๐",
    r"๐ฉ๐ฝ",
    r"๐พ ๐ ๐ ๐ ๐ ๐ ๐ ๐",
    r"๐ต ๐ ๐ ๐",
    r"โค๏ธ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐",
    r"โ๐ฟ ๐ช๐ฟ ๐๐ฟ ๐๐ฟ ๐๐ฟ ๐๐ฟ",
    r"๐พ ๐ ๐ ๐ ๐ ๐ ๐ ๐ง",
    r"0๏ธโฃ 1๏ธโฃ 2๏ธโฃ 3๏ธโฃ 4๏ธโฃ 5๏ธโฃ 6๏ธโฃ 7๏ธโฃ 8๏ธโฃ 9๏ธโฃ ๐",
    # Regional Indicator Symbols
    r"๐บ๐ธ๐ท๐บ๐ธ ๐ฆ๐ซ๐ฆ๐ฒ๐ธ",
    r"๐บ๐ธ๐ท๐บ๐ธ๐ฆ๐ซ๐ฆ๐ฒ",
    r"๐บ๐ธ๐ท๐บ๐ธ๐ฆ",
    # Unicode Numbers
    r"๏ผ๏ผ๏ผ",
    r"ูกูขูฃ",
    # Right-To-Left Strings
    r"ุซู ููุณ ุณูุทุช ูุจุงูุชุญุฏูุฏุ, ุฌุฒูุฑุชู ุจุงุณุชุฎุฏุงู ุฃู ุฏูู. ุฅุฐ ููุงุ ุงูุณุชุงุฑ ูุชูุตูุจ ูุงู. ุฃููู ุงูุทุงููุงุ ุจุฑูุทุงููุง-ูุฑูุณุง ูุฏ ุฃุฎุฐ. ุณูููุงูุ ุฅุชูุงููุฉ ุจูู ูุง, ูุฐูุฑ ุงูุญุฏูุฏ ุฃู ุจุนุฏ, ูุนุงููุฉ ุจูููุฏุงุ ุงูุฅุทูุงู ุนู ุฅูู.",
    r"ุฅูู.",
    r"ืึฐึผืจึตืืฉึดืืืช, ืึธึผืจึธื ืึฑืึนืึดืื, ืึตืช ืึทืฉึธึผืืึทืึดื, ืึฐืึตืช ืึธืึธืจึถืฅ",
    r"ืึธืึฐืชึธืtestุงูุตูุญุงุช ุงูุชูุญูู",
    r"๏ทฝ",
    r"๏ทบ",
    r"ููููุงููุดูุฉู ุณูุจููู ุงูุณูุชูุฎูุฏูุงูู ุงููููุบูุฉู ููู ุงููููุธููู ุงููููุงุฆูููุฉู ูููููู ููุฎูุตูู ุงูุชููุทูุจููููุงุชู ุงููุญุงุณููุจููููุฉูุ",
    # Trick Unicode
    r"โชโชtestโช",
    r"โซtest",
    r"โฉtestโฉ",
    r"testโtest",
    r"โฆtestโง",
    # Zalgo Text
    r"แนฐฬบฬบฬoอ ฬทiฬฒฬฌอฬชอnฬฬอvฬฬฬฬฆอoฬถฬฬฐฬkรจอฬฎฬบฬชฬนฬฑฬค ฬtฬอฬณฬฃฬปฬชอhฬผอฬฒฬฆฬณฬฬฒeอฬฃฬฐฬฆฬฌอ ฬขฬผฬปฬฑฬhอออฬฬฃฬฒอiฬฆฬฒฬฃฬฐฬคvฬปอeฬบฬญฬณฬชฬฐ-mฬขiอnฬฬบฬฬฒฬฏฬฐdฬตฬผฬอฬฉฬผฬฬณ ฬฬฅฬฑฬณฬญrฬฬฬeอpอrฬผฬฬปฬญฬeฬบฬฬฃอsฬอฬณอฬอeอฬฅฬฏฬฬฒอฬฌอวนฬฌออฬฬอฬคtอฬฌฬคอฬผฬญออiฬชฬฑnอgฬดอ อออcฬฌฬhอกaฬซฬปฬฏอoฬซฬฬอฬฬอsฬฬฆฬฒ.ฬจฬนอฬฃ",
    r"ฬกอฬอIฬฬฬฆอnอออvฬฎฬซokฬฒฬซฬอiฬอฬญฬนฬฬnฬกฬปฬฎฬฃฬบgฬฒออฬญอฬฌอ ฬฐtอฬฆhฬฬฒeฬขฬค อฬฌฬฒอfฬดฬอฬฃรจอแบนฬฅฬฉlอออiออฬฆอnออฬอฬณฬฎgอ ฬจoอฬชอกfฬฬฃฬฌ ฬฬอฬอฬฎcาอฬซอออออhฬตฬคฬฃออรกฬฬผออoฬผฬฃฬฅsฬฑอฬบฬฬฆฬปอข.ฬฬฬฬฬซฬฐ",
    r"ฬฬบอฬนฬฏอแนฎฬคอฬฅออhฬฒฬeออฬผฬฬฬผฬฃอ อฬฬฑฬอออNออeฬฬฑzฬฬฬฬบอpฬคฬบฬนอฬฏอeฬฬปฬอrฬจฬคอฬบฬอฬฬdฬฬฬญฬฌฬอiฬฆอฬฉออฬคaฬฬฬฌอฬnออ ฬปฬฬฐออhฬตอiฬณฬvฬขอแธออ-าฬญฬฉฬผอmฬคฬญฬซiออฬฬฆnฬอแธฬ ฬฏฬฒออวซฬฬฏฬฐฬฒอฬปฬf ฬชฬฐฬฐฬฬฬญฬอcฬฆอฬฒฬอฬฉฬแธฅอaฬฎอฬฬอฦกฬฉฬนอsฬค.ฬฬ าZฬกฬฬอฬฐฬฃอฬaอฬฐอฬฌอกlฬฒฬซฬณอฬฉgฬกฬฬผฬฑอฬฬฌอoฬอ.ฬ",
    r"ฬฆHฬฌฬคฬฬคอeอ ฬฬฅฬฬปอฬฬwฬhฬฬฏอoฬอฬอฬฑฬฎ าฬบฬฬฬอWฬทฬผฬญaฬบฬชอฤฏออฬญอฬฏฬtฬถฬผฬฎsฬออฬ ฬฬซฬBฬปอออฬณอeฬตhฬตฬฌอฬซอiฬนอฬณฬณฬฎอฬซฬnอdฬดฬชฬฬ ฬฐอฬฉออฬฒออTอฬผอฬชอขhออฬฎฬปeฬฌฬฬอ ฬคฬนฬWอฬฬออออaอออฬนฬผฬฃlฬดอฬฐฬคฬอแธฝฬซ.อ",
    r"ZฬฎฬฬอออแธฬฬอฬปฬแธถออฬฏฬนฬอGฬปOฬญฬฬฎ",
    # Unicode Upsidedown
    r"หษnbแดlษ ษuฦษษฏ วษนolop สว วษนoqษl สn สunpแดpแดษuแด ษนodษฏวส poษฏsnแดว op pวs 'สแดlว ฦuแดษsแดdแดpษ ษนnสวสษวsuoษ 'สวษฏษ สแดs ษนolop ษฏnsdแด ษฏวษนoหฅ",
    r"00หฦ$-",
    # Unicode font
    r"๏ผด๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ",
    r"๐๐ก๐ ๐ช๐ฎ๐ข๐๐ค ๐๐ซ๐จ๐ฐ๐ง ๐๐จ๐ฑ ๐ฃ๐ฎ๐ฆ๐ฉ๐ฌ ๐จ๐ฏ๐๐ซ ๐ญ๐ก๐ ๐ฅ๐๐ณ๐ฒ ๐๐จ๐",
    r"๐ฟ๐๐ ๐๐๐๐๐ ๐๐๐๐๐ ๐๐๐ ๐๐๐๐๐ ๐๐๐๐ ๐๐๐ ๐๐๐๐ ๐๐๐",
    r"๐ป๐๐ ๐๐๐๐๐ ๐๐๐๐๐ ๐๐๐ ๐๐๐๐๐ ๐๐๐๐ ๐๐๐ ๐๐๐๐ ๐๐๐",
    r"๐ฃ๐ฑ๐ฎ ๐บ๐พ๐ฒ๐ฌ๐ด ๐ซ๐ป๐ธ๐๐ท ๐ฏ๐ธ๐ ๐ณ๐พ๐ถ๐น๐ผ ๐ธ๐ฟ๐ฎ๐ป ๐ฝ๐ฑ๐ฎ ๐ต๐ช๐๐ ๐ญ๐ธ๐ฐ",
    r"๐๐๐ ๐ข๐ฆ๐๐๐ ๐๐ฃ๐๐จ๐ ๐๐๐ฉ ๐๐ฆ๐๐ก๐ค ๐๐ง๐๐ฃ ๐ฅ๐๐ ๐๐๐ซ๐ช ๐๐๐",
    r"๐๐๐ ๐๐๐๐๐ ๐๐๐๐๐ ๐๐๐ก ๐๐๐๐๐ ๐๐๐๐ ๐๐๐ ๐๐๐ฃ๐ข ๐๐๐",
    r"โฏโฃโ โฌโฐโคโโฆ โโญโชโฒโฉ โกโชโณ โฅโฐโจโซโฎ โชโฑโโญ โฏโฃโ โงโโตโด โโชโข",
    # File paths
    r"../../../../../../../../../../../etc/passwd%00",
    r"../../../../../../../../../../../etc/hosts",
    # iOS Vulnerabilities
    r"Powerููููุตูุจููููุตูุจูุฑุฑู เฅฃ เฅฃh เฅฃ เฅฃๅ",
    r"๐ณ0๐๏ธ",
]


@pytest.mark.slow
@pytest.mark.parametrize("text", NAUGHTY_STRINGS)
def test_tokenizer_naughty_strings(tokenizer, text):
    tokens = tokenizer(text)
    assert tokens.text_with_ws == text
