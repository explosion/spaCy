# coding: utf-8
from __future__ import unicode_literals

import pytest

# Examples taken from the "Big List of Naughty Strings"
# https://github.com/minimaxir/big-list-of-naughty-strings


NAUGHTY_STRINGS = [
    # ASCII punctuation
    ",./;'[]\-=",
    '<>?:"{}|_+',
    '!@#$%^&*()`~"',

    # Unicode additional control characters, byte order marks
    "ยญุุุุุุุแโโโโโโช",
    "๏ฟพ",

    # Unicode Symbols
    "ฮฉโรงโโซหยตโคโฅรท",
    "รฅรโฦยฉหโหยฌโฆรฆ",
    "ลโยดยฎโยฅยจหรธฯโโ",
    "ยกโขยฃยขโยงยถโขยชยบโโ",
    "ยธหรโฤฑหรยฏหยฟ",
    "รรรรหรร๏ฃฟรรรโ",
    "ลโยดโฐหรยจหรโโโ",
    "`โโฌโนโบ๏ฌ๏ฌโกยฐยทโโยฑ",
    "โโโโ",
    "ะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะะกะขะฃะคะฅะฆะงะจะฉะชะซะฌะญะฎะฏะฐะฑะฒะณะดะตะถะทะธะนะบะปะผะฝะพะฟัััััััััััััััั",
    "ููกูขูฃูคูฅูฆูงูจูฉ",

    # Unicode Subscript/Superscript/Accents
    "โฐโดโต",
    "โโโ",
    "โฐโดโตโโโ",
    "เธเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเน เธเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเน เธเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเนเน",

    # Two-Byte Characters
    "็ฐไธญใใใซใใใฆไธใใ",
    "ใใผใใฃใผใธ่กใใชใใ",
    "ๅ่ฃฝๆผข่ช",
    "้จ่ฝๆผ",
    "์ฌํ๊ณผํ์ ์ดํ์ฐ๊ตฌ์",
    "์ฐฆ์ฐจ๋ฅผ ํ๊ณ ์จ ํฒ์๋งจ๊ณผ ์๋ค๋ฆฌ ๋๋ฐฉ๊ฐํ",
    "็คพๆ็งๅญธ้ข่ชๅญธ็็ฉถๆ",
    "์ธ๋๋ฐํ๋ฅด",
    "๐๐ฑ๐น๐ฑ๐ฑธ๐ฒ๐ณ",

    # Japanese Emoticons
    "ใฝเผผเบูอเบเผฝ๏พ ใฝเผผเบูอเบเผฝ๏พ",
    "(๏ฝกโ โ โ๏ฝก)",
    "๏ฝ๏ฝจ(ยดโ๏ฝโฉ",
    "__๏พ(,_,*)",
    "ใป(๏ฟฃโ๏ฟฃ)ใป:*:",
    "๏พ๏ฝฅโฟใพโฒ(๏ฝกโโฟโ๏ฝก)โฑโฟ๏ฝฅ๏พ",
    ",ใใป:*:ใปใโ( โป ฯ โป )ใใป:*:ใปใโ",
    "(โฏยฐโกยฐ๏ผโฏ๏ธต โปโโป)"
    "(๏พเฒฅ็เฒฅ๏ผ๏พ๏ปฟ โปโโป",
    "โฌโโฌใ( ยบ _ ยบใ)",
    "( อกยฐ อส อกยฐ)",

    # Emoji
    "๐",
    "๐ฉ๐ฝ",
    "๐พ ๐ ๐ ๐ ๐ ๐ ๐ ๐",
    "๐ต ๐ ๐ ๐",
    "โค๏ธ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐ ๐",
    "โ๐ฟ ๐ช๐ฟ ๐๐ฟ ๐๐ฟ ๐๐ฟ ๐๐ฟ",
    "๐พ ๐ ๐ ๐ ๐ ๐ ๐ ๐ง",
    "0๏ธโฃ 1๏ธโฃ 2๏ธโฃ 3๏ธโฃ 4๏ธโฃ 5๏ธโฃ 6๏ธโฃ 7๏ธโฃ 8๏ธโฃ 9๏ธโฃ ๐",

    # Regional Indicator Symbols
    "๐บ๐ธ๐ท๐บ๐ธ ๐ฆ๐ซ๐ฆ๐ฒ๐ธ",
    "๐บ๐ธ๐ท๐บ๐ธ๐ฆ๐ซ๐ฆ๐ฒ",
    "๐บ๐ธ๐ท๐บ๐ธ๐ฆ",

    # Unicode Numbers
    "๏ผ๏ผ๏ผ",
    "ูกูขูฃ",

    # Right-To-Left Strings

    "ุซู ููุณ ุณูุทุช ูุจุงูุชุญุฏูุฏุ, ุฌุฒูุฑุชู ุจุงุณุชุฎุฏุงู ุฃู ุฏูู. ุฅุฐ ููุงุ ุงูุณุชุงุฑ ูุชูุตูุจ ูุงู. ุฃููู ุงูุทุงููุงุ ุจุฑูุทุงููุง-ูุฑูุณุง ูุฏ ุฃุฎุฐ. ุณูููุงูุ ุฅุชูุงููุฉ ุจูู ูุง, ูุฐูุฑ ุงูุญุฏูุฏ ุฃู ุจุนุฏ, ูุนุงููุฉ ุจูููุฏุงุ ุงูุฅุทูุงู ุนู ุฅูู.",
    "ุฅูู.",
    "ืึฐึผืจึตืืฉึดืืืช, ืึธึผืจึธื ืึฑืึนืึดืื, ืึตืช ืึทืฉึธึผืืึทืึดื, ืึฐืึตืช ืึธืึธืจึถืฅ",
    "ืึธืึฐืชึธืtestุงูุตูุญุงุช ุงูุชูุญูู",
    "๏ทฝ",
    "๏ทบ",
    "ููููุงููุดูุฉู ุณูุจููู ุงูุณูุชูุฎูุฏูุงูู ุงููููุบูุฉู ููู ุงููููุธููู ุงููููุงุฆูููุฉู ูููููู ููุฎูุตูู ุงูุชููุทูุจููููุงุชู ุงููุญุงุณููุจููููุฉูุ",

    # Trick Unicode
    "โชโชtestโช",
    "โซtest",
    "โฉtestโฉ",
    "testโtest",
    "โฆtestโง",

    # Zalgo Text
    "แนฐฬบฬบฬoอ ฬทiฬฒฬฌอฬชอnฬฬอvฬฬฬฬฆอoฬถฬฬฐฬkรจอฬฎฬบฬชฬนฬฑฬค ฬtฬอฬณฬฃฬปฬชอhฬผอฬฒฬฆฬณฬฬฒeอฬฃฬฐฬฆฬฌอ ฬขฬผฬปฬฑฬhอออฬฬฃฬฒอiฬฆฬฒฬฃฬฐฬคvฬปอeฬบฬญฬณฬชฬฐ-mฬขiอnฬฬบฬฬฒฬฏฬฐdฬตฬผฬอฬฉฬผฬฬณ ฬฬฅฬฑฬณฬญrฬฬฬeอpอrฬผฬฬปฬญฬeฬบฬฬฃอsฬอฬณอฬอeอฬฅฬฏฬฬฒอฬฌอวนฬฌออฬฬอฬคtอฬฌฬคอฬผฬญออiฬชฬฑnอgฬดอ อออcฬฌฬhอกaฬซฬปฬฏอoฬซฬฬอฬฬอsฬฬฆฬฒ.ฬจฬนอฬฃ",


    "ฬกอฬอIฬฬฬฆอnอออvฬฎฬซokฬฒฬซฬอiฬอฬญฬนฬฬnฬกฬปฬฎฬฃฬบgฬฒออฬญอฬฌอ ฬฐtอฬฆhฬฬฒeฬขฬค อฬฌฬฒอfฬดฬอฬฃรจอแบนฬฅฬฉlอออiออฬฆอnออฬอฬณฬฎgอ ฬจoอฬชอกfฬฬฃฬฌ ฬฬอฬอฬฎcาอฬซอออออhฬตฬคฬฃออรกฬฬผออoฬผฬฃฬฅsฬฑอฬบฬฬฆฬปอข.ฬฬฬฬฬซฬฐ",


    "ฬฬบอฬนฬฏอแนฎฬคอฬฅออhฬฒฬeออฬผฬฬฬผฬฃอ อฬฬฑฬอออNออeฬฬฑzฬฬฬฬบอpฬคฬบฬนอฬฏอeฬฬปฬอrฬจฬคอฬบฬอฬฬdฬฬฬญฬฌฬอiฬฆอฬฉออฬคaฬฬฬฌอฬnออ ฬปฬฬฐออhฬตอiฬณฬvฬขอแธออ-าฬญฬฉฬผอmฬคฬญฬซiออฬฬฆnฬอแธฬ ฬฏฬฒออวซฬฬฏฬฐฬฒอฬปฬf ฬชฬฐฬฐฬฬฬญฬอcฬฆอฬฒฬอฬฉฬแธฅอaฬฎอฬฬอฦกฬฉฬนอsฬค.ฬฬ าZฬกฬฬอฬฐฬฃอฬaอฬฐอฬฌอกlฬฒฬซฬณอฬฉgฬกฬฬผฬฑอฬฬฌอoฬอ.ฬ",


    "ฬฆHฬฌฬคฬฬคอeอ ฬฬฅฬฬปอฬฬwฬhฬฬฏอoฬอฬอฬฑฬฎ าฬบฬฬฬอWฬทฬผฬญaฬบฬชอฤฏออฬญอฬฏฬtฬถฬผฬฎsฬออฬ ฬฬซฬBฬปอออฬณอeฬตhฬตฬฌอฬซอiฬนอฬณฬณฬฎอฬซฬnอdฬดฬชฬฬ ฬฐอฬฉออฬฒออTอฬผอฬชอขhออฬฎฬปeฬฌฬฬอ ฬคฬนฬWอฬฬออออaอออฬนฬผฬฃlฬดอฬฐฬคฬอแธฝฬซ.อ",


    "ZฬฎฬฬอออแธฬฬอฬปฬแธถออฬฏฬนฬอGฬปOฬญฬฬฎ",


    # Unicode Upsidedown
    "หษnbแดlษ ษuฦษษฏ วษนolop สว วษนoqษl สn สunpแดpแดษuแด ษนodษฏวส poษฏsnแดว op pวs 'สแดlว ฦuแดษsแดdแดpษ ษนnสวสษวsuoษ 'สวษฏษ สแดs ษนolop ษฏnsdแด ษฏวษนoหฅ",
    "00หฦ$-",

    # Unicode font
    "๏ผด๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ๏ฝ ๏ฝ๏ฝ๏ฝ",
    "๐๐ก๐ ๐ช๐ฎ๐ข๐๐ค ๐๐ซ๐จ๐ฐ๐ง ๐๐จ๐ฑ ๐ฃ๐ฎ๐ฆ๐ฉ๐ฌ ๐จ๐ฏ๐๐ซ ๐ญ๐ก๐ ๐ฅ๐๐ณ๐ฒ ๐๐จ๐",
    "๐ฟ๐๐ ๐๐๐๐๐ ๐๐๐๐๐ ๐๐๐ ๐๐๐๐๐ ๐๐๐๐ ๐๐๐ ๐๐๐๐ ๐๐๐",
    "๐ป๐๐ ๐๐๐๐๐ ๐๐๐๐๐ ๐๐๐ ๐๐๐๐๐ ๐๐๐๐ ๐๐๐ ๐๐๐๐ ๐๐๐",
    "๐ฃ๐ฑ๐ฎ ๐บ๐พ๐ฒ๐ฌ๐ด ๐ซ๐ป๐ธ๐๐ท ๐ฏ๐ธ๐ ๐ณ๐พ๐ถ๐น๐ผ ๐ธ๐ฟ๐ฎ๐ป ๐ฝ๐ฑ๐ฎ ๐ต๐ช๐๐ ๐ญ๐ธ๐ฐ",
    "๐๐๐ ๐ข๐ฆ๐๐๐ ๐๐ฃ๐๐จ๐ ๐๐๐ฉ ๐๐ฆ๐๐ก๐ค ๐๐ง๐๐ฃ ๐ฅ๐๐ ๐๐๐ซ๐ช ๐๐๐",
    "๐๐๐ ๐๐๐๐๐ ๐๐๐๐๐ ๐๐๐ก ๐๐๐๐๐ ๐๐๐๐ ๐๐๐ ๐๐๐ฃ๐ข ๐๐๐",
    "โฏโฃโ โฌโฐโคโโฆ โโญโชโฒโฉ โกโชโณ โฅโฐโจโซโฎ โชโฑโโญ โฏโฃโ โงโโตโด โโชโข",

    # File paths
    "../../../../../../../../../../../etc/passwd%00",
    "../../../../../../../../../../../etc/hosts",

    # iOS Vulnerabilities
    "Powerููููุตูุจููููุตูุจูุฑุฑู เฅฃ เฅฃh เฅฃ เฅฃๅ",
    "๐ณ0๐๏ธ"
]


@pytest.mark.slow
@pytest.mark.parametrize('text', NAUGHTY_STRINGS)
def test_tokenizer_naughty_strings(tokenizer, text):
    tokens = tokenizer(text)
    assert tokens.text_with_ws == text
